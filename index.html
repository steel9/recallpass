<!doctype html>
<html>
	<body onload="generatePassword()" style="min-height: 100%">
		<style>
			@font-face { 
				font-family: Roboto-Thin;
				src: url('files/Roboto-Thin.TTF');
				src: url('files/roboto-thin.woff') format('woff'),
					 url('files/roboto-thin.woff2') format('woff2');
			} 
			@font-face {
				font-family: Roboto-Regular;
				src: url('files/Roboto-Regular.TTF');
				src: url('files/roboto-regular.woff') format('woff'),
					 url('files/roboto-regular.woff2') format('woff2');
			}			
			
			h1 {
				font-family: Roboto-Thin
			}
			
			h2 {
				font-family: Roboto-Thin
			}
			
			p {
				font-family: Roboto-Thin
			}
			#generate {
				font-family: Roboto-Regular
			}
		</style>
		<center>
			<img src="files/recallpasslogo.png"/><h1>BETA</h1>
			<br>
			<br>
			<br>
			<script type="text/javascript">
				<!--Symbols are modified to produce an easier to remember password-->
				const symbols="!#%&=@£$€";
				const separators="._-,;";
				
				String.prototype.insert = function (index, string) {
					if (index > 0)
						return this.substring(0, index) + string + this.substring(index, this.length);
					else
						return string + this;
				};

				function generatePassword() {
					document.getElementById('passwordtitle').innerHTML = 'Please wait...';
					var pass = "";
					var sep = separators[Math.floor(Math.random() * separators.length)];
					var words;
					var request = new XMLHttpRequest();
					request.onreadystatechange = function(){
						if (request.readyState === XMLHttpRequest.DONE)
						{
							words = request.responseText.split('\n');
							var myList = words.ToList();
							myList.RemoveRange(0, 35);
							words = myList.ToArray();
							
							for (i = 0; i < 3; i++)
							{
								pass += words[Math.floor(Math.random() * (words.length - 35)) + 35];
								pass += sep + symbols[Math.floor(Math.random() * symbols.length)];
							}
							
							document.getElementById('password').innerHTML = pass;
							document.getElementById('passwordtitle').innerHTML = "Here's a fresh generated password:";
							document.getElementById('facts').innerHTML = words.length;
						}
					};
					request.open("GET","files/words.txt", true);
					request.send();
				}
				
				function showDisclaimer() {
					var request = new XMLHttpRequest();
					request.onreadystatechange = function(){
						if (request.readyState === XMLHttpRequest.DONE)
						{
							alert(request.responseText);
							return;
						}
					};
					request.open("GET","disclaimer.txt", true);
					request.send();
				}
				
				function openGitHub() {
					var win = window.open('https://github.com/steel9/recallpass', '_blank');
					if (win) {
						win.focus();
					} else {
						alert('Please allow popups for this website');
					}
				}
				
				function showLicenses() {
					var win = window.open('https://github.com/steel9/recallpass/tree/master/licenses', '_blank');
					if (win) {
						win.focus();
					} else {
						alert('Please allow popups for this website');
					}
				}
			</script>
			<form action="" method="">
				<h2 id="passwordtitle"></h2>
				<p id="password" style="font-size: 250%"></p>
				<br>
				<input type="button" id="generate" value="Generate new" style="
				width:250px;
				height:35px;
				background-color:rgb(0,204,0);
				border-style:solid;border-left-color:rgb(0,204,0);
				border-top-color:rgb(0,204,0);
				border-right-color:rgb(0,204,0);
				border-bottom-color:rgb(0,204,0);
				color:rgb(255,255,255)" onclick="generatePassword()"/>
			</form>
			<br>
			<br>
			<p>___________________________________</p>
			<h2><span style="color: rgb(235, 134, 20)">Secure </span>passwords that you can <span style="color: rgb(235, 134, 20)">remember</span> (hopefully)</h2>
			<br>
			<p>Words in <A HREF="http://wordlist.aspell.net/">wordlist</A>: <p id="facts"></p><p>
		</center>
	</body>
	<footer>
		<center>
			<img src="files/steel9appslogo.png"/>
		<center>
		<input type="button" value="Disclaimer" onclick="showDisclaimer()">
		<input type="button" value="Licenses" onclick="showLicenses()">
		<input type="button" value="GitHub" onclick="openGitHub()">
	</footer>
</html>